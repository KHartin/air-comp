---
title: "Xuanwei_Thesis"
author: "Kris Hartin"
date: "May 8, 2015"
output: pdf_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
summary(cars)
```

You can also embed plots, for example:

```{r, echo=FALSE}
plot(cars)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

Upload the dataset, exclude results from Xuanwei city, view table
```{R}
Xuanwei_ForAnalysis_31Mar15 <- read.csv("H:/Seto_Projects/Xuanwei/Xuanwei_ForAnalysis_31Mar15.csv")
X<-subset(Xuanwei_ForAnalysis_31Mar15, village != "Xuanwei")
```

Reduce number of metals to those with at least 10 greater than 2*Unc
```{R}
grepl("Unc",names(X))
metals.unc <- names(X)[grepl("Unc",names(X))]

v<-vector()

for(i in 1:length(names(X))){
  if(grepl("Unc",names(X)[i])){
    if(sum(X[,i-1]>X[,i]*2)>10){
    v<-c(v,paste(names(X)[i-1],"V",sep=""))
  }
}
}  
```

Calculate arithmetic mean of data by site
```{R}
v<-c(v,names(X)[grepl("ugV",names(X))])

this.formula <- as.character("conc~location + sitenum")  
for (i in v){
  this.formula <- paste(i,this.formula, sep = "+")
}

am.site <- summaryBy(as.formula(this.formula), data=X, id = "village", keep.names=TRUE, FUN=mean)
```

Create new objects -> Home, Ambient, Mean and Geometric Mean Home Concentrations ####

```{R}
is.home <- subset(X, location == "Home")
is.ambient <- subset(X, location == "Ambient")
```

Plots of Conc by Site, Differentiating Indoor and Outdoor 
```{R}
plot(X$conc~X$sitenum,log="y",ylab="Concentration ug/m^3", xlab="Site Number",
     main="PM2.5 Concentration by Site")

```

